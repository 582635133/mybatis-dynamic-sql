<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/docs/update.md at 07 April 2019
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190407" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis Dynamic SQL &#x2013; Update Statements</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script type="text/javascript" src="../js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="../docs/introduction.html" id="bannerLeft"><h2>MyBatis Dynamic SQL</h2>
</a></div>
        <div class="pull-right"><a href="../../" id="bannerRight" title="MyBatis logo"><img src="http://mybatis.github.io/images/mybatis-logo.png"  alt="MyBatis logo"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 07 April 2019<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.1.1</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">User's Guide</li>
    <li><a href="../docs/introduction.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li><a href="../docs/quickStart.html" title="Quick Start"><span class="none"></span>Quick Start</a></li>
    <li><a href="../docs/whereClauses.html" title="WHERE Clause Support"><span class="icon-chevron-down"></span>WHERE Clause Support</a>
    <ul class="nav nav-list">
    <li><a href="../docs/conditions.html" title="WHERE Conditions"><span class="none"></span>WHERE Conditions</a></li>
    </ul>
</li>
    <li><a href="../docs/select.html" title="SELECT Statements"><span class="none"></span>SELECT Statements</a></li>
    <li><a href="../docs/delete.html" title="DELETE Statements"><span class="none"></span>DELETE Statements</a></li>
    <li><a href="../docs/insert.html" title="INSERT Statements"><span class="none"></span>INSERT Statements</a></li>
    <li class="active"><a href="#"><span class="none"></span>UPDATE Statements</a></li>
    <li><a href="../docs/mybatis3.html" title="MyBatis3 Support"><span class="none"></span>MyBatis3 Support</a></li>
    <li><a href="../docs/spring.html" title="Spring Support"><span class="none"></span>Spring Support</a></li>
    <li><a href="../docs/springBatch.html" title="Spring Batch Support"><span class="none"></span>Spring Batch Support</a></li>
    <li><a href="../docs/howItWorks.html" title="How it Works"><span class="none"></span>How it Works</a></li>
    <li><a href="../docs/extending.html" title="Extending the Library"><span class="none"></span>Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html" title="Coding Standards"><span class="none"></span>Coding Standards</a></li>
    <li><a href="../docs/motivation.html" title="Motivation"><span class="none"></span>Motivation</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Update Statements</h1>
<p>Update statements are composed by specifying the table and columns to update, and an optional where clause.  For example:</p>

<div>
<div>
<pre class="source">    UpdateStatementProvider updateStatement = update(animalData)
            .set(bodyWeight).equalTo(record.getBodyWeight())
            .set(animalName).equalToNull()
            .where(id, isIn(1, 5, 7))
            .or(id, isIn(2, 6, 8), and(animalName, isLike(&quot;%bat&quot;)))
            .or(id, isGreaterThan(60))
            .and(bodyWeight, isBetween(1.0).and(3.0))
            .build()
            .render(RenderingStrategy.MYBATIS3);

    int rows = mapper.update(updateStatement);
</pre></div></div>

<p>Notice the <tt>set</tt> method. It is used to set the value of a database column.  There are several options for setting a value:</p>
<ol style="list-style-type: decimal">

<li><tt>set(column).equalToNull()</tt> will set a null into a column</li>
<li><tt>set(column).equalToConstant(String constant)</tt> will set a constant into a column.  The constant_value will be written into the generated update statement exactly as entered</li>
<li><tt>set(column).equalToStringConstant(String constant)</tt> will set a constant into a column.  The constant_value will be written into the generated update statement surrounded by single quote marks (as an SQL String)</li>
<li><tt>set(column).equalTo(T value)</tt> will set a value into a column.  The value will be bound to the SQL statement as a prepared statement parameter</li>
<li><tt>set(column).equalTo(Supplier&lt;T&gt; valueSupplier)</tt> will set a value into a column.  The value will be bound to the SQL statement as a prepared statement parameter</li>
<li><tt>set(column).equalToWhenPresent(T value)</tt> will set a value into a column if the value is non-null.  The value of the property will be bound to the SQL statement as a prepared statement parameter.  This is used to generate a &#x201c;selective&#x201d; update as defined in MyBatis Generator.</li>
<li><tt>set(column).equalToWhenPresent(Supplier&lt;T&gt; valueSupplier)</tt> will set a value into a column if the value is non-null.  The value of the property will be bound to the SQL statement as a prepared statement parameter.  This is used to generate a &#x201c;selective&#x201d; update as defined in MyBatis Generator.</li>
<li><tt>set(column).equalTo(Buildable&lt;SelectModel&gt; selectModelBuilder)</tt> will set the result of a sub-query into a column.  The query should only have one column and the type of the returned column must be able to be converted by the database if it is not the same type. These constraints are NOT validated by the library.</li>
<li><tt>set(column).equalTo(BasicColumn rightColumn)</tt> will set the value of a column the be the value of another column.  This is also useful for specifying a function such as add, subtract, etc.</li>
</ol>
<p>You can also build an update statement without a where clause.  This will update every row in a table. For example:</p>

<div>
<div>
<pre class="source">    UpdateStatementProvider updateStatement = update(animalData)
            .set(bodyWeight).equalTo(record.getBodyWeight())
            .set(animalName).equalToNull()
            .build()
            .render(RenderingStrategy.MYBATIS3);
</pre></div></div>

<div class="section">
<h2><a name="Annotated_Mapper_for_Update_Statements"></a>Annotated Mapper for Update Statements</h2>
<p>The UpdateStatementProvider object can be used as a parameter to a MyBatis mapper method directly.  If you are using an annotated mapper, the update method should look like this:</p>

<div>
<div>
<pre class="source">import org.apache.ibatis.annotations.UpdateProvider;
import org.mybatis.dynamic.sql.update.render.UpdateStatementProvider;
import org.mybatis.dynamic.sql.util.SqlProviderAdapter;

...
    @UpdateProvider(type=SqlProviderAdapter.class, method=&quot;update&quot;)
    int update(UpdateStatementProvider updateStatement);
...

</pre></div></div>
</div>
<div class="section">
<h2><a name="XML_Mapper_for_Update_Statements"></a>XML Mapper for Update Statements</h2>
<p>We do not recommend using an XML mapper for update statements, but if you want to do so the UpdateStatementProvider object can be used as a parameter to a MyBatis mapper method directly.</p>
<p>If you are using an XML mapper, the update method should look like this in the Java interface:</p>

<div>
<div>
<pre class="source">import org.mybatis.dynamic.sql.update.render.UpdateStatementProvider;

...
    int update(UpdateStatementProvider updateStatement);
...

</pre></div></div>

<p>The XML element should look like this:</p>

<div>
<div>
<pre class="source">  &lt;update id=&quot;update&quot;&gt;
    ${updateStatement}
  &lt;/update&gt;
</pre></div></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2016&#x2013;2019
<a href="http://www.mybatis.org/">MyBatis.org</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
